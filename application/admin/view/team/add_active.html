<include file="public/layout"/>

<body style="background-color: rgb(255, 255, 255); overflow: auto; cursor: default; -moz-user-select: inherit;">
        <div id="toolTipLayer" style="position: absolute; z-index: 9999; display: none; visibility: visible; left: 95px; top: 573px;"></div>
        <div id="append_parent"></div>
        <div id="ajaxwaitid"></div>
        <div class="page">

            <form class="form-horizontal" id="handleposition" method="post" onsubmit="return false;">

                <div class="ncap-form-default">

                    
                        <dl class="row">
                                <dt class="tit">
                                    <label><em>*</em>层级</label>
                                </dt>
                                <dd class="opt">
                                    <input type="radio" name="goods_id" data-id="2"/>
                                    <input type="text" value="{$Request.param.keywords}" name="goods_id" data-id="2"/>
                                    <p class="notic">请填写层级</p>
                                </dd>
                            </dl>
                            
                            <!-- <dl class="row">
                                    <dt class="tit">
                                        <label><em>*</em>拼团价格</label>
                                    </dt>
                                    <dd class="opt">
                                        <input type="radio" id="myId" name="act_name1" value="" class="input-txt">
                                        <p class="notic">请填写拼团价格</p>
                                    </dd>
                            </dl> -->
<!-- 
                            <dl class="row">
                                    <dt class="tit">
                                        <label><em>*</em>拼团人数</label>
                                    </dt>
                                    <dd class="opt">
                                        <input type="radio" name="act_name2" value="" class="input-txt">
                                        <p class="notic">请填写拼团人数</p>
                                    </dd>
                            </dl> -->
                    
                    <div class="bot"><a onclick="select_goods()" class="ncap-btn-big ncap-btn-green">确认提交</a></div>
                </div>
            </form>
        </div>
<script type="text/javascript">
   // 点击刷新数据
   $('.fa-refresh').click(function(){
        location.href = location.href;
    });
    $(document).ready(function(){
        $("input[type='radio']:checked").each(function(i,o){
            var goods_id = $(this).data('id');
            $('#spec_goods_id_'+goods_id).show();
        })
    });
    //商品对象
    function GoodsItem(goods_id, goods_name, store_count, goods_price, cost_price, goods_image,spec) {
        this.goods_id = goods_id;
        this.goods_name = goods_name;
        this.store_count = store_count;
        this.goods_price = goods_price;
        this.cost_price = cost_price;
        this.goods_image = goods_image;
        this.spec = spec;
    }
    //商品对象
    function GoodsSpecItem(item_id, key_name, store_count, price ,spec_img) {
        this.item_id = item_id;
        this.key_name = key_name;
        this.store_count = store_count;
        this.price = price;
        this.spec_img = spec_img;
    }
    //单选框选中事件
    $(function () {
        $(document).on("click", '#flexigrid input', function (e) {
            var goods_id = $(this).data('id');
            if($(this).is(':checked')){
                $('#spec_goods_id_'+goods_id).show();
            }else{
                $('#spec_goods_id_'+goods_id).hide();
            }
        })
    })
    //规格按钮点击事件
    $(function () {
        $(document).on("click", '.specBtn', function (e) {
            $(this).parent().find('a').css("color","#777").removeClass('ncap-btn-green');
            $(this).css("color","#FFF").addClass('ncap-btn-green');
        })
    })

    function select_goods()
    {
        var show = "";
        var input = $("input[type='radio']:checked");
        var apm = document.getElementsByName('goods_id');
        show = apm.value;
        alert(show);
        if (input.length == 0) {
            layer.alert('请选择商品', {icon: 2}); //alert('请选择商品');
            return false;
        }
        // alert('0');
        var goods_id = input.data('id');
        // alert(goods_id);
        var spec = $('#spec_goods_id_'+goods_id);
        var goodsItem = null;
        if(spec.length == 0){
            goodsItem = new GoodsItem(input.data('id'), input.data('name'),input.data('count'), input.data('price'),input.data('cost-price'),input.data('img'), null);
           
        }else{
            var spec_a = spec.find('.ncap-btn-green');
            if(spec_a.length == 0){
                layer.alert('请选择要参与活动的商品规格', {icon: 2}); //alert('请选择商品');
            }else{
                var goodsSpecItem = new GoodsSpecItem(spec_a.data('item-id'),spec_a.data('key-name'),spec_a.data('store-count'),spec_a.data('price'),spec_a.data('spec-img'));
                goodsItem = new GoodsItem(input.data('id'), input.data('name'), input.data('count'),input.data('price'),input.data('cost-price'), input.data('img'), goodsSpecItem);
            }
        }
      
        window.parent.call_back(goodsItem);
    }

</script>
        
</body>
</html>